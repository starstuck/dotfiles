# -*- sh -*-

# Workaround for older bash versions, which does not support compopt utility.
# It make break some completions, but at least they will load and there is chance
# that some basic features will still work
if ! command -v compopt
then
  compopt () {
    :
  }
fi

load_completions()
{
  echo "Loading completions from $1"
  local COMPLETION_DIR="$1"
  for i in $(LC_ALL=C command ls "$COMPLETION_DIR"); do
    [[ (! ${i##*/} =~ (^\.#|\.(bak|swp)$) ) \
         && -f $COMPLETION_DIR/$i \
		 && -n $(which $i 2>/dev/null) ]] && . "$COMPLETION_DIR/$i"
  done
}

for D in $(echo "$BASH_COMPLETION" | tr ":" "\n" )
do
  load_completions "$D"
done
